[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Problemas de Bioestadística",
    "section": "",
    "text": "Prefacio\nColección de problemas de Bioestadística para el Master en Nutrigenómica.",
    "crumbs": [
      "Prefacio"
    ]
  },
  {
    "objectID": "01-contrastes-parametricos.html",
    "href": "01-contrastes-parametricos.html",
    "title": "1  Contrastes de hipótesis paramétricos",
    "section": "",
    "text": "Ejercicio 1.1 Sabiendo que el año pasado el consumo per cápita de azúcar en España fue de \\(4.8\\) kg y que este consumo sigue una distribución normal, hemos seleccionado aleatoriamente a \\(20\\) españoles obteniendo una media muestral de \\(5\\) kg y una cuasidesviación típica muestral de \\(0.4\\) kg. Contrastar la hipótesis de que el consumo de azúcar per cápita de este año en España no ha variado utilizando un nivel de significación del \\(10\\)%.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nSea \\(X\\sim N(\\mu,\\sigma)\\) la variable aleatoria que mide el consumo per cápita de azúcar en España.\nNúmero de poblaciones: 1 población. Variable dependiente: Consumo de azúcar (cuantitativa).\nTamaño muestral: \\(n=20\\).\nContraste de la media de una población normal (prueba t): \\(H_0:\\mu=4.8\\), \\(H_1:\\mu\\neq 4.8\\).\nEstadístico del contraste: \\(t=2.24\\)\np-valor: \\(p =2 P(t(19)&gt;2.24) = 0.037\\).\nComo el p-valor es menor que el nivel de significación \\(\\alpha = 0.1\\), se rechaza la hipótesis nula y se concluye que el consumo de azúcar per cápita de este año en España ha variado.\n\n\n\n\nEjercicio 1.2 En una clase de alumnos de primaria se ha comprobado que el \\(20\\)% del alumnado consume bollería industrial. Para disminuir esta preocupante cifra, el colegio ha implantado un programa de educación nutricional. Después del programa se tomó una muestra aleatoria de \\(50\\) alumnos de primaria y se observó que 8 seguían consumiendo bollería industrial. Contrastar con un nivel de significación del \\(5\\)% si el programa es efectivo.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 1 población.\nVariable dependiente: Consumo de bollería industrial (cualitativa binaria).\nTamaño muestral: \\(n=50\\).\nContraste para la proporción de una población: \\(H_0:p=0.2\\), \\(H_1:p&lt; 0.2\\).\np-valor: \\(p=0.2979\\).\nComo el p-valor es mayor que el nivel de significación \\(\\alpha = 0.05\\), no se rechaza la hipótesis nula y se concluye que no hay evidencias significativas de que el programa sea efectivo.\n\n\n\n\nEjercicio 1.3 Se sabe que el consumo anual de helado correspondiente a cada español sigue una distribución normal y que el año pasado el consumo medio fue de 20 kg. Queremos contrastar si este año se va a mantener el consumo medio de helado que el año pasado, y para comprobarlo se efectúa una muestra aleatoria de 22 españoles, obteniéndose los resultados recogidos en el fichero consumo-helado.csv. Realizar el contraste con un nivel de significación de \\(0.10\\).\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 1 población.\nVariable dependiente: Consumo de helado (cuantitativa).\nTamaño muestral: \\(n=22\\).\nPrueba de normalidad de Kolmogorov-Smirnov. p-valor: \\(p=0.632\\). Se acepta la normalidad.\nContraste de la media de una población normal (prueba t): \\(H_0:\\mu=20\\), \\(H_1:\\mu\\neq 20\\).\np-valor: \\(p = 0.8033\\).\nComo el p-valor es mayor que el nivel de significación \\(\\alpha = 0.10\\), no se rechaza la hipótesis nula y se concluye que el consumo medio de helado de este año en España se va a mantener.\n\n\n\n\nEjercicio 1.4 Se ha realizado un estudio para comparar los niveles de hierro en sangre antes y después de un programa de ejercicios. Los datos del estudio están en el fichero niveles-hierro-ejercicio.csv. Realizar el contraste de hipótesis adecuado para ver si el ejercicio aumenta el nivel de hierro con un nivel de significación del 1%.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 2 poblaciones pareadas (población 1: antes de hacer ejercicio, población 2: después de hacer ejercicio).\nVariable dependiente: Nivel de hierro (cuantitativa).\nTamaño muestral: \\(n=20\\).\nPrueba de normalidad de Kolmogorov-Smirnov: p-valor de la diferencia: \\(0.804\\). Se acepta la normalidad.\nContraste para la comparación de medias de poblaciones pareadas: \\(H_0:\\mu_d=0\\), \\(H_1:\\mu_d&lt; 0\\).\np-valor: \\(p=0.0011\\).\nComo el p-valor es menor que el nivel de significación se rechaza la hipótesis nula y se concluye que el programa de ejercicios ha aumentado significativamente el nivel de hierro en sangre.\n\n\n\n\nEjercicio 1.5 Se ha realizado un estudio para comparar los niveles de glucosa en sangre de dos grupos: uno sigue una dieta baja en carbohidratos y otro una dieta estándar. Los datos del estudio están en el fichero niveles-glucosa-dietas.csv. Realizar el contraste de hipótesis adecuado para comparar las medias de los dos grupos con un nivel de significación del 5%.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 2 poblaciones independientes (población 1: dieta baja en carbohidratos, población 2: dieta estándar).\nVariable dependiente: Nivel de glucosa (cuantitativa).\nTamaños muestrales: \\(n_1=30\\), \\(n_2=30\\).\nContraste de comparación de varianzas: \\(H_0:\\sigma_1^2=\\sigma_2^2\\), \\(H_1:\\sigma_1^2\\neq \\sigma_2^2\\). p-valor: \\(p=0.25\\). Se acepta la hipótesis nula de igualdad de varianzas.\nContraste para la comparación de medias de poblaciones independientes con varianzas iguales: \\(H_0:\\mu_1=\\mu_2\\), \\(H_1:\\mu_1&lt;\\mu_2\\).\np-valor: \\(p=0.00009\\). Como el p-valor es menor que el nivel de significación se rechaza la hipótesis nula y se concluye que el nivel de glucosa en sangre es significativamente menor en el grupo que sigue una dieta baja en carbohidratos.\n\n\n\n\nEjercicio 1.6 Se ha realizado un estudio para comparar los niveles de expresión de un gen en función de la dieta (vegetariana u omnívora). Los datos del estudio están en el fichero expresion-genica-dietas.csv. Realizar el contraste de hipótesis adecuado para comparar las medias de los dos grupos.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 2 poblaciones independientes (población 1: dieta vegetariana, población 2: dieta omnívora).\nVariable dependiente: Expresión génica (cuantitativa).\nTamaños muestrales: \\(n_1=20\\), \\(n_2=25\\).\nPrueba de normalidad de Kolmogorov-Smirnov: p-valor primera muestra: \\(0.4164\\), p-valor segunda muestra: \\(0.2767\\). Se acepta la normalidad en ambos grupos.\nContraste de comparación de varianzas: \\(H_0:\\sigma_1^2=\\sigma_2^2\\), \\(H_1:\\sigma_1^2\\neq \\sigma_2^2\\). p-valor: \\(p=0.1373\\). Se acepta la hipótesis nula de igualdad de varianzas.\nContraste para la comparación de medias de poblaciones independientes con varianzas iguales: \\(H_0:\\mu_1=\\mu_2\\), \\(H_1:\\mu_1&lt;\\mu_2\\).\np-valor: \\(p=0.00006\\).\nComo el p-valor es menor que el nivel de significación, se rechaza la hipótesis nula y se concluye que existen diferencias estadísticamente significativas en los niveles de expresión génica en función de la dieta.\n\n\n\n\nEjercicio 1.7 Se utiliza un grupo de 150 pacientes para comprobar la teoría de que la vitamina C tiene alguna influencia en el tratamiento del cáncer. Los 150 pacientes fueron divididos en dos grupos de 75. Un grupo recibió 10 gramos de vitamina C y el otro un placebo cada día, además de la medicación habitual. De los que recibieron la vitamina C, 47 presentaban alguna mejoría al cabo de cuatro semanas, mientras que de los que recibieron el placebo, 43 experimentaron mejoría. Contrastar la hipótesis de que la vitamina C tiene influencia en el tratamiento del cáncer con un nivel de significación del 5%.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 2 poblaciones independientes (población 1: vitamina C, población 2: placebo).\nVariable dependiente: Mejoría en el tratamiento del cáncer (cualitativa binaria).\nTamaños muestrales: \\(n_1=75\\), \\(n_2=75\\).\nContraste para la comparación de proporciones: \\(H_0:p_1=p_2\\), \\(H_1:p_1\\neq p_2\\).\np-valor: \\(p=0.6824\\).\nComo el p-valor es mayor que el nivel de significación, no se rechaza la hipótesis nula y se concluye que no hay evidencias significativas de que la vitamina C tenga influencia en el tratamiento del cáncer.\n\n\n\n\nEjercicio 1.8 En un estudio sobre el consumo de alcohol entre los jóvenes durante los fines de semana, se preguntó a 100 chicos y a 125 chicas, de los que 63 chicos y 59 chicas contestaron que consumían. En vista de estos datos, ¿existe alguna diferencia significativa entre las proporciones de chicos y chicas que consumen alcohol los fines de semana?\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 2 poblaciones independientes (población 1: chicos, población 2: chicas).\nVariable dependiente: Consumo de alcohol (cualitativa binaria).\nTamaños muestrales: \\(n_1=100\\), \\(n_2=125\\).\nContraste para la comparación de proporciones: \\(H_0:p_1=p_2\\), \\(H_1:p_1\\neq p_2\\).\np-valor: \\(p=0.0163\\).\nComo el p-valor es menor que el nivel de significación, se rechaza la hipótesis nula y se concluye que hay diferencias significativas entre el consumo de alcohol de chicos y chicas.\n\n\n\n\nEjercicio 1.9 En un estudio de genómica nutricional, se evalúa cómo afecta la suplementación con diferentes tipos de macronutrientes a la expresión de un gen relacionado con el metabolismo energético. Los investigadores dividen a los participantes en tres grupos, cada uno recibiendo una dieta suplementada (1 carbohidratos, 2 proteínas y 3 grasas).Se mide el nivel de expresión génica (ΔCt, relativo a un gen de referencia) en 25 individuos por grupo. Los resultados se recogen en el fichero expresion-genica-suplementacion.csv. Realizar el contraste de hipótesis adecuado para comparar ver si hay diferencias estadísticamente significativas entre las expresiones génicas de los tres grupos.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 3 poblaciones independientes (población 1: Carbohidratos, población 2: Proteínas, población 3: Grasas).\nVariable dependiente: Expresión génica (cuantitativa).\nTamaños muestrales: \\(n_1=75\\), \\(n_2=75\\) y \\(n_3=75\\).\nContraste de normalidad de Kolmogorov-Smirnov: p-valor primera muestra: \\(0.7571\\), p-valor segunda muestra: \\(0.6459\\), p-valor tercera muestra: \\(0.9643\\). Se acepta la normalidad en los tres grupos.\nContraste de homocedasticidad de Levene: p-valor: \\(0.2126\\). Se acepta la hipótesis de igualdad de varianzas.\nContraste de ANOVA: \\(H_0:\\mu_1=\\mu_2=\\mu_3\\), \\(H_1:\\) Al menos dos medias son diferentes.\np-valor: \\(p=0.000283\\).\nComo el p-valor es menor que el nivel de significación, se rechaza la hipótesis nula y se concluye que hay diferencias significativas entre las medias de la expresión génica de los grupos de suplementación.\nContraste post hoc de Tukey:\n- Carbohidratos vs Proteínas: \\(p=0.0016\\). Hay diferencias significativas.\n- Carbohidratos vs Grasas: \\(p=0.0009\\). Hay diferencias significativas.\n- Proteínas vs Grasas: \\(p=0.9809\\). No hay diferencias significativas.\n\n\n\n\nEjercicio 1.10 En un estudio diseñado para analizar la influencia de un tipo de dieta y de un fármaco en el peso corporal perdido, se ha anotado el número de Kg perdidos en un grupo de personas al cabo de 3 meses de dieta y de tomar el fármaco en el fichero interaccion-dieta-farmaco.csv. Realizar el contraste de hipótesis adecuado para ver si el peso perdido depende de la dieta, del fármaco y de la interacción entre ambos.\n\n\n\n\n\n\n\nSolución\n\n\n\n\n\nNúmero de poblaciones: 4 poblaciones independientes (población 1: Dieta No + Fármaco No, población 2: Dieta No + Fármaco Si, población 3: Dieta Si + Fármaco No, población 4: Dieta Si + Fármaco Si).\nVariable dependiente: Peso perdido (cuantitativa).\nTamaños muestrales: \\(n_1=5\\), \\(n_2=6\\), \\(n_3=5\\) y \\(n_4=6\\).\nContraste de normalidad de Shapiro-Wilk: p-valor primera muestra: \\(0.4677\\), p-valor segunda muestra: \\(0.9672\\), p-valor tercera muestra: \\(0.741\\), p-valor cuarta muestra: \\(0.719\\). Se acepta la normalidad en los cuatro grupos.\nContraste de homocedasticidad de Levene: p-valor: \\(0.845\\). Se acepta la hipótesis de igualdad de varianzas.\nContraste de ANOVA de dos factores con interacción: \\(H_0:\\) No hay interacción entre la dieta y el fármaco, \\(H_1:\\) Hay interacción entre la dieta y el fármaco.\n- p-valor dieta: \\(p=0.0000\\).\n- p-valor fármaco: \\(p=0.0000\\).\n- p-valor interacción: \\(p=0.0012\\).\nComo el p-valor es menor que el nivel de significación en los tres casos, se rechaza la hipótesis nula y se concluye que la pérdida de peso depende de la dieta, del fármaco y de la interacción entre ambos.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Contrastes de hipótesis paramétricos</span>"
    ]
  },
  {
    "objectID": "01-contrastes-parametricos-practicas.html",
    "href": "01-contrastes-parametricos-practicas.html",
    "title": "2  Prácticas de contrastes de hipótesis paramétricos con R",
    "section": "",
    "text": "Ejercicio 2.1 Se sabe que el consumo anual de helado correspondiente a cada español sigue una distribución normal y que el año pasado el consumo medio fue de 20 kg. Queremos contrastar si este año se va a mantener el consumo medio de helado que el año pasado, y para comprobarlo se efectúa una muestra aleatoria de 22 españoles. Los datos obtenidos están disponibles en el fichero consumo-helado.csv.\nRealizar el contraste con un nivel de significación de 0.10.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nEn primer lugar cargamos los datos en un data frame y mostramos las primeras filas.\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(knitr)\nlibrary(broom)\ndf &lt;- read.csv(\"datos/consumo-helado.csv\")\nhead(df)\n\n  helado\n1     15\n2     18\n3     24\n4     31\n5     22\n6     12\n\n\nHacemos un análisis descriptivo básico.\n\ndf |&gt; \n    summarise(\n        n = n(),\n        media = mean(helado, na.rm = TRUE),\n        desviación_típica = sd(helado, na.rm = TRUE)\n    ) |&gt; \n    kable()\n\n\n\n\nn\nmedia\ndesviación_típica\n\n\n\n\n22\n19.5\n9.297977\n\n\n\n\n\nComprobamos la normalidad de los datos.\n\ntidy(shapiro.test(df$helado)) |&gt; \n    kable()\n\n\n\n\nstatistic\np.value\nmethod\n\n\n\n\n0.9721157\n0.7595164\nShapiro-Wilk normality test\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación 0.05, aceptamos la hipótesis de normalidad.\nAplicamos el contraste t para la media de una población normal.\n\ntidy(t.test(df$helado, mu = 20, alternative = \"two.sided\")) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n19.5\n-0.2522277\n0.8033173\n21\n15.37751\n23.62249\nOne Sample t-test\ntwo.sided\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación \\(0.10\\) aceptamos la hipótesis nula y concluimos que no hay evidencias significativas de que el consumo medio de helado este año será distinto del año pasado.\n\n\n\n\nEjercicio 2.2 En una clase de alumnos de primaria se ha comprobado que el \\(20\\)% del alumnado consume bollería industrial. Para disminuir esta preocupante cifra, el colegio ha implantado un programa de educación nutricional. Después del programa se tomó una muestra aleatoria de \\(50\\) alumnos de primaria y se observó que 8 seguían consumiendo bollería industrial. Contrastar con un nivel de significación del \\(5\\)% si el programa es efectivo.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\ntidy(prop.test(8, 50, alternative = \"less\", p = 0.2)) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.16\n0.28125\n0.2979415\n1\n0\n0.273716\n1-sample proportions test with continuity correction\nless\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación \\(0.05\\), concluimos que no hay evidencias significativas para afirmar que el programa está siendo efectivo.\n\n\n\n\nEjercicio 2.3 Se ha realizado un estudio para comparar los niveles de hierro en sangre antes y después de un programa de ejercicios. Los datos del estudio están en el fichero niveles-hierro-ejercicio.csv. Realizar el contraste de hipótesis adecuado para ver si el ejercicio aumenta el nivel de hierro con un nivel de significación del 1%.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nEn primer lugar cargamos los datos en un data frame y mostramos la primeras filas.\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(broom)\ndf &lt;- read.csv(\"datos/niveles-hierro-ejercicio.csv\")\n\nCreamos una nueva variable con la diferencia entre el nivel de hierro después y antes de hacer ejercicio.\n\ndf &lt;- df |&gt; \n    mutate(incremento = Hierro.Despues - Hierro.Antes)\n\nComprobamos la normalidad de la variable incremento.\n\ntidy(shapiro.test(df$incremento)) |&gt; \n    kable()\n\n\n\n\nstatistic\np.value\nmethod\n\n\n\n\n0.9753185\n0.860638\nShapiro-Wilk normality test\n\n\n\n\n\nAplicamos el contraste t para la comparación de medias de dos poblaciones pareadas.\n\ntidy(t.test(df$Hierro.Despues, df$Hierro.Antes, alternative = \"greater\", paired = TRUE)) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.6669\n3.533911\n0.0011089\n19\n0.3405877\nInf\nPaired t-test\ngreater\n\n\n\n\n\nComo el p-valor es menor que el nivel de significación \\(0.01\\) aceptamos la hipótesis nula y concluimos que hay evidencias significativas de que el ejercicio aumenta el nivel de hierro. Además, de acuerdo al intervalo de confianza, el incremento de hierro estaría por encima de 0.341 \\(\\mu\\)mol/L$.\n\n\n\n\nEjercicio 2.4 Se ha realizado un estudio para comparar los niveles de glucosa en sangre de dos grupos: uno sigue una dieta baja en carbohidratos y otro una dieta estándar. Los datos del estudio están en el fichero niveles-glucosa-dietas.csv. Realizar el contraste de hipótesis adecuado para comparar las medias de los dos grupos con un nivel de significación del 5%.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nEn primer lugar cargamos los datos en un data frame y mostramos las primeras filas.\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(broom)\ndf &lt;- read.csv(\"datos/niveles-glucosa-dietas.csv\")\nhead(df)\n\n              Grupo Glucosa\n1 BajaCarbohidratos    90.0\n2 BajaCarbohidratos    83.6\n3 BajaCarbohidratos    91.5\n4 BajaCarbohidratos   100.2\n5 BajaCarbohidratos    82.7\n6 BajaCarbohidratos    82.7\n\n\nHacemos un análisis descriptivo básico.\n\ndf |&gt; \n    group_by(Grupo) |&gt; \n    summarise(\n        n = n(),\n        media = mean(Glucosa, na.rm = TRUE),\n        desviación_típica = sd(Glucosa, na.rm = TRUE)\n    ) |&gt; \n    kable()\n\n\n\n\nGrupo\nn\nmedia\ndesviación_típica\n\n\n\n\nBajaCarbohidratos\n30\n83.13000\n8.992992\n\n\nEstandar\n30\n93.55333\n11.174223\n\n\n\n\n\nComprobamos la normalidad de los datos.\n\ndf |&gt; \n    group_by(Grupo) |&gt; \n    summarise(test = tidy(shapiro.test(Glucosa))) |&gt; \n    unnest(test) |&gt; \n    kable()\n\n\n\n\nGrupo\nstatistic\np.value\nmethod\n\n\n\n\nBajaCarbohidratos\n0.9749854\n0.6822997\nShapiro-Wilk normality test\n\n\nEstandar\n0.9835426\n0.9098542\nShapiro-Wilk normality test\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación 0.05 en ambos grupos aceptamos la hipótesis de normalidad.\nA continuación aplicamos el contraste de comparación de varianzas de poblaciones normales.\n\ntidy(var.test (Glucosa ~ Grupo, data = df)) |&gt; \n    kable()\n\nMultiple parameters; naming those columns num.df and den.df.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nnum.df\nden.df\nstatistic\np.value\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.6476997\n29\n29\n0.6476997\n0.2481074\n0.3082822\n1.360814\nF test to compare two variances\ntwo.sided\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación \\(0.05\\) asumimos varianzas iguales.\nA ahora aplicamos el contraste t para la comparación de medias de dos poblaciones independientes con varianzas iguales.\n\ntidy(t.test(Glucosa ~ Grupo, data = df, alternative = \"two.sided\", var.equal = TRUE)) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nestimate1\nestimate2\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n-10.42333\n83.13\n93.55333\n-3.980255\n0.000194\n58\n-15.66535\n-5.181315\nTwo Sample t-test\ntwo.sided\n\n\n\n\n\nComo el p-valor es menor que el nivel de significación \\(0.05\\) rechazamos la hipótesis nula y concluimos que existen diferencias estadísticamente significativas entre el nivel medio de glucosa en sangre de las dos dietas.\nPor último mostramos el diagrama de medias con los respectivos intervalos de confianza.\n\ndf |&gt; \n    ggplot(aes(x = Grupo, y = Glucosa, color = I(\"blue\"))) +\n    stat_summary(fun.data = ~ mean_cl_normal(., conf.int = 0.95), geom = \"pointrange\", position = position_dodge(width = 0.5))\n\nWarning: Computation failed in `stat_summary()`.\nCaused by error in `mean_cl_normal()`:\n! The package \"Hmisc\" is required.\n\n\n\n\n\n\n\n\n\n\n\n\n\nEjercicio 2.5 Se ha realizado un estudio para comparar los niveles de expresión de un gen en función de la dieta (vegetariana u omnívora). Los datos del estudio están en el fichero expresion-genica-dietas.csv. Realizar el contraste de hipótesis adecuado para comparar las medias de los dos grupos.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nEn primer lugar cargamos los datos en un data frame y mostramos las primeras filas.\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(broom)\ndf &lt;- read.csv(\"datos/expresion-genica-dietas.csv\")\nhead(df)\n\n        Grupo Expresion.Genica\n1 Vegetariana            0.735\n2 Vegetariana            1.221\n3 Vegetariana            0.881\n4 Vegetariana            1.342\n5 Vegetariana            0.924\n6 Vegetariana            1.665\n\n\nHacemos un análisis descriptivo básico.\n\ndf |&gt; \n    group_by(Grupo) |&gt; \n    summarise(\n        n = n(),\n        media = mean(Expresion.Genica, na.rm = TRUE),\n        desviación_típica = sd(Expresion.Genica, na.rm = TRUE)\n    ) |&gt; \n    kable()\n\n\n\n\nGrupo\nn\nmedia\ndesviación_típica\n\n\n\n\nOmnivora\n25\n1.62672\n0.4087498\n\n\nVegetariana\n20\n1.14680\n0.2917002\n\n\n\n\n\nComprobamos la normalidad de los datos.\n\ndf |&gt; \n    group_by(Grupo) |&gt; \n    summarise(test = tidy(shapiro.test(Expresion.Genica))) |&gt; \n    unnest(test) |&gt; \n    kable()\n\n\n\n\nGrupo\nstatistic\np.value\nmethod\n\n\n\n\nOmnivora\n0.9578432\n0.3731950\nShapiro-Wilk normality test\n\n\nVegetariana\n0.9372700\n0.2128177\nShapiro-Wilk normality test\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación 0.05 en ambos grupos aceptamos la hipótesis de normalidad.\nA continuación aplicamos el contraste de comparación de varianzas de poblaciones normales.\n\ntidy(var.test (Expresion.Genica ~ Grupo, data = df)) |&gt; \n    kable()\n\nMultiple parameters; naming those columns num.df and den.df.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nnum.df\nden.df\nstatistic\np.value\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n1.963548\n24\n19\n1.963548\n0.1373252\n0.8006898\n4.604823\nF test to compare two variances\ntwo.sided\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación \\(0.05\\) asumimos varianzas iguales.\nFinalmente aplicamos el contraste t para la comparación de medias de dos poblaciones independientes con varianzas iguales.\n\ntidy(t.test(Expresion.Genica ~ Grupo, data = df, alternative = \"two.sided\", var.equal = TRUE), conf.int = TRUE) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate\nestimate1\nestimate2\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.47992\n1.62672\n1.1468\n4.422438\n6.54e-05\n43\n0.2610699\n0.6987701\nTwo Sample t-test\ntwo.sided\n\n\n\n\n\nComo el p-valor es menor que el nivel de significación \\(0.05\\) rechazamos la hipótesis nula y concluimos que existen diferencias estadísticamente significativas entre el nivel medio de expresión génica de las dos dietas. Además, según el intervalo de confianza del 95%, el nivel de expresión génica con la dieta omnívora estaría sería entre \\(0.261\\) y \\(0.699\\) mayor que con la dieta vegetariana.\n\n\n\n\nEjercicio 2.6 Se utiliza un grupo de 150 pacientes para comprobar la teoría de que la vitamina C tiene alguna influencia en el tratamiento del cáncer. Los 150 pacientes fueron divididos en dos grupos de 75. Un grupo recibió 10 gramos de vitamina C y el otro un placebo cada día, además de la medicación habitual. De los que recibieron la vitamina C, 47 presentaban alguna mejoría al cabo de cuatro semanas, mientras que de los que recibieron el placebo, 43 experimentaron mejoría. Contrastar la hipótesis de que la vitamina C tiene influencia en el tratamiento del cáncer con un nivel de significación del 5%.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\ntidy(prop.test(c(47, 43), c(75, 75), alternative = \"two.sided\")) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate1\nestimate2\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.6266667\n0.5733333\n0.25\n0.6170751\n1\n-0.1165647\n0.2232313\n2-sample test for equality of proportions with continuity correction\ntwo.sided\n\n\n\n\n\nComo el p-valor del contraste es mayor que el nivel de significación \\(0.05\\), se acepta la hipótesis nula y se concluye que no hay evidencias significativas de que la vitamina C influya en el tratamiento del cáncer.\n\n\n\n\nEjercicio 2.7 En un estudio sobre el consumo de alcohol entre los jóvenes durante los fines de semana, se preguntó a 100 chicos y a 125 chicas, de los que 63 chicos y 59 chicas contestaron que consumían. En vista de estos datos, ¿existe alguna diferencia significativa entre las proporciones de chicos y chicas que consumen alcohol los fines de semana?\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\ntidy(prop.test(c(63, 59), c(100, 125), alternative = \"two.sided\"), conf.int = TRUE) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nestimate1\nestimate2\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.63\n0.472\n4.968989\n0.0258057\n1\n0.0201075\n0.2958925\n2-sample test for equality of proportions with continuity correction\ntwo.sided\n\n\n\n\n\nComo el p-valor del contraste es menor que el nivel de significación \\(0.05\\), se rechaza la hipótesis nula y se concluye que hay diferencias estadísticamente significativas entre la proporción de chicos y chicas que consumen alcohol los fines de semana. Además, según el intervalo de confianza del 95%, el porcentaje de chicos sería entre un \\(2.01\\)% y un \\(29.6\\)% mayor que el de chicas.\n\n\n\n\nEjercicio 2.8 En un estudio de genómica nutricional, se evalúa cómo afecta la suplementación con diferentes tipos de macronutrientes a la expresión de un gen relacionado con el metabolismo energético. Los investigadores dividen a los participantes en tres grupos, cada uno recibiendo una dieta suplementada (1 carbohidratos, 2 proteínas y 3 grasas).Se mide el nivel de expresión génica (ΔCt, relativo a un gen de referencia) en 25 individuos por grupo. Los resultados se recogen en el fichero expresion-genica-suplementacion.csv. Realizar el contraste de hipótesis adecuado para comparar ver si hay diferencias estadísticamente significativas entre las expresiones génicas de los tres grupos.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nEn primer lugar cargamos los datos en un data frame y mostramos las primeras filas.\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(broom)\ndf &lt;- read.csv(\"datos/expresion-genica-suplementacion.csv\")\nhead(df)\n\n  Suplementacion Expresion.genica\n1  Carbohidratos            1.299\n2  Carbohidratos            1.172\n3  Carbohidratos            1.330\n4  Carbohidratos            1.505\n5  Carbohidratos            1.153\n6  Carbohidratos            1.153\n\n\nHacemos un análisis descriptivo básico.\n\ndf |&gt; \n    group_by(Suplementacion) |&gt; \n    summarise(\n        n = n(),\n        media = mean(Expresion.genica, na.rm = TRUE),\n        desviación_típica = sd(Expresion.genica, na.rm = TRUE)\n    ) |&gt; \n    kable()\n\n\n\n\nSuplementacion\nn\nmedia\ndesviación_típica\n\n\n\n\nCarbohidratos\n25\n1.16728\n0.1913774\n\n\nGrasas\n25\n1.42656\n0.2468005\n\n\nProteinas\n25\n1.41380\n0.2777301\n\n\n\n\n\nAplicamos el contraste de ANOVA para la comparación de medias de más de dos poblaciones independientes.\n\nanova &lt;- aov(Expresion.genica ~ Suplementacion, data = df)\ntidy(anova) |&gt; \n    kable()\n\n\n\n\nterm\ndf\nsumsq\nmeansq\nstatistic\np.value\n\n\n\n\nSuplementacion\n2\n1.068009\n0.5340044\n9.171666\n0.000283\n\n\nResiduals\n72\n4.192075\n0.0582233\nNA\nNA\n\n\n\n\n\nComo el p-valor es menor que el nivel de significación \\(0.05\\), rechazamos la hipótesis nula y concluimos que existen pruebas estadísticamente significativas de que el nivel de expresión génica depende del la dieta.\nA continuación comprobamos si se cumplen los requisitos del contraste de ANOVA.\n\nNormalidad de los residuos.\n\nresiduals &lt;- residuals(anova)\npar(mfrow = c(1, 2))  \nhist(residuals)\nqqnorm(residuals, main = \"Q-Q Plot of Residuals\")\nqqline(residuals, col = \"red\", lwd = 2)\n\n\n\n\n\n\n\ntidy(shapiro.test(residuals)) |&gt; \nkable()\n\n\n\n\nstatistic\np.value\nmethod\n\n\n\n\n0.9926311\n0.9455761\nShapiro-Wilk normality test\n\n\n\n\n\nTanto el histograma como el gráfico de cuantiles no muestran una desviación significativa de una distribución normal, y como el p-valor del contraste de normalidad es mayor que el nivel de significación \\(0.05\\), se asume que los residuos siguen una distribución normal.\nHomogeneidad de varianzas. Aplicamos el test de Levene para la comparación de varianzas.\n\nlibrary(car)\n\nCargando paquete requerido: carData\n\n\n\nAdjuntando el paquete: 'car'\n\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\n\nThe following object is masked from 'package:purrr':\n\n    some\n\ntidy(leveneTest(Expresion.genica ~ Suplementacion, data = df)) |&gt; \nkable()\n\nWarning in leveneTest.default(y = y, group = group, ...): group coerced to\nfactor.\n\n\n\n\n\nstatistic\np.value\ndf\ndf.residual\n\n\n\n\n1.582187\n0.2125867\n2\n72\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación \\(0.05\\) se acepta la hipótesis nula y se asume homogeneidad de varianzas.\nAsí pues, se cumplen los requisitos para el contraste de ANOVA.\n\nFinalmente hacemos una comparación de medias por pares para ver entre qué grupos hay diferencias estadísticamente significativas.\n\ntidy(TukeyHSD(anova)) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\nterm\ncontrast\nnull.value\nestimate\nconf.low\nconf.high\nadj.p.value\n\n\n\n\nSuplementacion\nGrasas-Carbohidratos\n0\n0.25928\n0.0959528\n0.4226072\n0.0008694\n\n\nSuplementacion\nProteinas-Carbohidratos\n0\n0.24652\n0.0831928\n0.4098472\n0.0016018\n\n\nSuplementacion\nProteinas-Grasas\n0\n-0.01276\n-0.1760872\n0.1505672\n0.9809191\n\n\n\n\n\nSe observan diferencias estadísticamente significativas entre las medias de la dieta basada en grasas y la basada en carbohidratos (p-valor \\(0.0008 &lt; 0.05\\)) y también entre la dieta basada en proteínas y la basada en carbohidratos (p-valor \\(0.0016 &lt; 0.05\\)), pero no entre la dieta basada en proteínas y la basada en grasas (p-valor \\(0.981 &gt; 0.05\\)).\n\ntidy(TukeyHSD(anova)) |&gt; \n    ggplot(aes(x = contrast, y = estimate)) +\n    geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = \"blue\") +\n    geom_point(size = 3, color = \"red\") +\n    geom_hline(yintercept = 0, linetype = \"dashed\")\n\n\n\n\n\n\n\n\n\n\n\n\nEjercicio 2.9 En un estudio diseñado para analizar la influencia de un tipo de dieta y de un fármaco en el peso corporal perdido, se ha anotado el número de Kg perdidos en un grupo de personas al cabo de 3 meses de dieta y de tomar el fármaco en el fichero interaccion-dieta-farmaco.csv. Realizar el contraste de hipótesis adecuado para ver si el peso perdido depende de la dieta, del fármaco y de la interacción entre ambos.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nEn primer lugar cargamos los datos en un data frame y mostramos las primeras filas.\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(broom)\ndf &lt;- read.csv(\"datos/interaccion-dieta-farmaco.csv\")\nhead(df)\n\n  Dieta Farmaco Perdida_peso\n1    No      No          1.5\n2    No      No          0.5\n3    No      No          0.0\n4    No      No         -1.0\n5    No      No         -1.0\n6    No      Si          6.5\n\n\nHacemos un análisis descriptivo básico.\n\ndf |&gt; \n    group_by(Dieta, Farmaco) |&gt; \n    summarise(\n        n = n(),\n        media = mean(Perdida_peso, na.rm = TRUE),\n        desviación_típica = sd(Perdida_peso, na.rm = TRUE)\n    ) |&gt; \n    kable()\n\n`summarise()` has grouped output by 'Dieta'. You can override using the\n`.groups` argument.\n\n\n\n\n\nDieta\nFarmaco\nn\nmedia\ndesviación_típica\n\n\n\n\nNo\nNo\n5\n0.000000\n1.0606602\n\n\nNo\nSi\n6\n5.166667\n1.4375906\n\n\nSi\nNo\n5\n3.000000\n0.7905694\n\n\nSi\nSi\n6\n12.000000\n1.1832160\n\n\n\n\n\nAplicamos el contraste de ANOVA de dos factores para la comparación de medias de más de dos poblaciones independientes.\n\nanova &lt;- aov(Perdida_peso ~ Dieta * Farmaco, data = df)\ntidy(anova) |&gt; \n    kable()\n\n\n\n\nterm\ndf\nsumsq\nmeansq\nstatistic\np.value\n\n\n\n\nDieta\n1\n142.54545\n142.545455\n105.44458\n0.0000000\n\n\nFarmaco\n1\n273.67424\n273.674242\n202.44396\n0.0000000\n\n\nDieta:Farmaco\n1\n20.03788\n20.037879\n14.82254\n0.0011731\n\n\nResiduals\n18\n24.33333\n1.351852\nNA\nNA\n\n\n\n\n\nSe observa que la dieta es significativa (p-valor \\(5.93e-9 &lt; 0.05\\)), el fármaco es significativo (p-valor \\(3.11e-11 &lt; 0.05\\)) y también la interacción entre la dieta y el fármaco es significativa (p-valor \\(0.00117 &lt; 0.05\\)).\nA continuación comprobamos si se cumplen los requisitos del contraste de ANOVA.\n\nNormalidad de los residuos.\n\nresiduals &lt;- residuals(anova)\npar(mfrow = c(1, 2))  \nhist(residuals)\nqqnorm(residuals, main = \"Q-Q Plot of Residuals\")\nqqline(residuals, col = \"red\", lwd = 2)\n\n\n\n\n\n\n\ntidy(shapiro.test(residuals)) |&gt; \nkable()\n\n\n\n\nstatistic\np.value\nmethod\n\n\n\n\n0.967452\n0.6521599\nShapiro-Wilk normality test\n\n\n\n\n\nTanto el histograma como el gráfico de cuantiles no muestran una desviación significativa de una distribución normal, y como el p-valor del contraste de normalidad es mayor que el nivel de significación \\(0.05\\), se asume que los residuos siguen una distribución normal.\nHomogeneidad de varianzas. Aplicamos el test de Levene para la comparación de varianzas.\n\nlibrary(car)\ntidy(leveneTest(Perdida_peso ~ Dieta * Farmaco, data = df)) |&gt; \nkable()\n\n\n\n\nstatistic\np.value\ndf\ndf.residual\n\n\n\n\n0.2715568\n0.845079\n3\n18\n\n\n\n\n\nComo el p-valor es mayor que el nivel de significación \\(0.05\\) se acepta la hipótesis nula y se asume homogeneidad de varianzas.\nAsí pues, se cumplen los requisitos para el contraste de ANOVA.\n\nFinalmente hacemos una comparación de medias por pares para ver entre qué grupos hay diferencias estadísticamente significativas.\n\ntidy(TukeyHSD(anova)) |&gt; \n    kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\nterm\ncontrast\nnull.value\nestimate\nconf.low\nconf.high\nadj.p.value\n\n\n\n\nDieta\nSi-No\n0\n5.090909\n4.0493279\n6.132490\n0.0000000\n\n\nFarmaco\nSi-No\n0\n7.083333\n6.0374212\n8.129245\n0.0000000\n\n\nDieta:Farmaco\nSi:No-No:No\n0\n3.000000\n0.9216855\n5.078315\n0.0035774\n\n\nDieta:Farmaco\nNo:Si-No:No\n0\n5.166667\n3.1768320\n7.156501\n0.0000046\n\n\nDieta:Farmaco\nSi:Si-No:No\n0\n12.000000\n10.0101653\n13.989835\n0.0000000\n\n\nDieta:Farmaco\nNo:Si-Si:No\n0\n2.166667\n0.1768320\n4.156501\n0.0300974\n\n\nDieta:Farmaco\nSi:Si-Si:No\n0\n9.000000\n7.0101653\n10.989835\n0.0000000\n\n\nDieta:Farmaco\nSi:Si-No:Si\n0\n6.833333\n4.9361004\n8.730566\n0.0000000\n\n\n\n\n\nSe observan diferencias estadísticamente significativas entre todos los grupos de comparación.\n\ntidy(TukeyHSD(anova)) |&gt; \n    ggplot(aes(x = contrast, y = estimate)) +\n    geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = \"blue\") +\n    geom_point(size = 3, color = \"red\") +\n    geom_hline(yintercept = 0, linetype = \"dashed\")\n\n\n\n\n\n\n\n\n\n\n\n\nEjercicio 2.10 Después de tomar un litro de vino se ha medido la concentración de alcohol en la sangre en distintos instantes, obteniendo los siguientes datos\n\\[\n\\begin{array}{lrrrrrrr}\n\\hline\n\\mbox{Tiempo después (minutos)} & 30 & 60 & 90 & 120 & 150 & 180 & 210\\\\\n\\mbox{Alcohol (gramos/litro)} & 1.6 & 1.7 & 1.5 & 1.1 & 0.7 & 0.2 & 2.1\\\\\n\\hline\n\\end{array}\n\\]\n\nCrear un data frame con los datos del tiempo y la concentración de alcohol.\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\ndf &lt;- data.frame(\n    Tiempo = c(30, 60, 90, 120, 150, 180, 210),\n    Alcohol = c(1.6, 1.7, 1.5, 1.1, 0.7, 0.2, 2.1)\n)\ndf\n\n  Tiempo Alcohol\n1     30     1.6\n2     60     1.7\n3     90     1.5\n4    120     1.1\n5    150     0.7\n6    180     0.2\n7    210     2.1\n\n\n\n\n\nCalcular el coeficiente de correlación lineal. ¿Existe relación lineal entre la concentración de alcohol y el tiempo que pasa?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nPara calcular el coeficiente de correlación lineal de Pearson se puede utilar la función cor del paquete stats.\n\ncor(df$Tiempo, df$Alcohol)\n\n[1] -0.2730367\n\n\nEl valore del coeficiente de correlación lineal es muy bajo, por lo que aparentemente no hay relación lineal entre la concentración de alcohol en sangre y el tiempo que pasa.\n\n\n\nDibujar el diagrama de dispersión correspondiente y la recta de regresión de la concentración de alcohol sobre el tiempo. ¿Por qué el ajuste es tan malo?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\nlibrary(ggplot2)\nggplot(df, aes(x = Tiempo, y = Alcohol)) +\n    geom_point(col = \"red\") +\n    geom_smooth(method = \"lm\") +\n    labs(title = \"Diagrama de dispersión\", x = \"Tiempo en minutos\", y = \"Concentración de alcohol en sangre (g/l)\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nEl ajuste es malo porque hay un dato atípico que no sigue la misma tendencia que el resto.\n\n\n\nEliminar el dato atípico y calcular la recta de la concentración de alcohol sobre el tiempo. ¿Ha mejorado el modelo?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\n# Eliminamos el dato atípico que está en la fila \ndf &lt;- df[-c(7), ]\nrecta_alcohol_tiempo &lt;- lm(Alcohol ~ Tiempo, df) \nsummary(recta_alcohol_tiempo)\n\n\nCall:\nlm(formula = Alcohol ~ Tiempo, data = df)\n\nResiduals:\n       1        2        3        4        5        6 \n-0.27619  0.12095  0.21810  0.11524  0.01238 -0.19048 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  2.173333   0.201927  10.763 0.000423 ***\nTiempo      -0.009905   0.001728  -5.731 0.004591 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2169 on 4 degrees of freedom\nMultiple R-squared:  0.8914,    Adjusted R-squared:  0.8643 \nF-statistic: 32.84 on 1 and 4 DF,  p-value: 0.004591\n\n\nLa recta de regresión de la concentración de alcohol en sangre sobre el tiempo es \\(\\textsf{alcohol}= 2.1733333 + -0.0099048 \\textsf{tiempo}\\).\nEl modelo ha mejorado notablemente ya que ahora el coeficiente de determinación lineal \\(R^2=0.8914286\\), que está muy próximo a 1.\n\n\n\nSegún el modelo de regresión lineal, ¿a qué velocidad metaboliza esta persona el alcohol?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\ncat(paste(\"Coeficiente de regresión de la concentración de alchol sobre el tiempo:\", recta_alcohol_tiempo$coefficients[[\"Tiempo\"]]))\n\nCoeficiente de regresión de la concentración de alchol sobre el tiempo: -0.00990476190476191\n\n\nAsí pues, la velocidad de metabolización del alcohol es 0.0099048 g/l\\(\\cdot\\)min.\n\n\n\nSi la concentración máxima de alcohol en la sangre que permite la ley para poder conducir es \\(0.3\\) g/l, ¿cuánto tiempo habrá que esperar después de tomarse un litro de vino para poder conducir sin infringir la ley? ¿Es fiable esta predicción?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nComo ahora queremos predecir el tiempo, necesitamos calcular la recta de regresión del tiempo sobre la concentración de alcohol.\n\nrecta_tiempo_alcohol &lt;- lm(Tiempo ~ Alcohol, df) \npredict.lm(recta_tiempo_alcohol, newdata = list(Alcohol = 0.3))\n\n  1 \n180 \n\n\nAunque el coeficiente de determinación lineal está próximo a 1, el tamaño muestral es demasiado pequeño para que la predicción sea fiable.\n\n\n\n\n\n\nEjercicio 2.11 El fichero dieta.csv contiene información sobre el los kilos perdidos con una dieta de adelgazamiento.\n\nCrear un data frame con los datos de la dieta a partir del fichero dieta.csv.\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\nlibrary(readr)\ndf &lt;- read_csv(\"https://aprendeconalf.es/estadistica-practicas-r/datos/dieta.csv\")\n\nRows: 40 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): ejercicio\ndbl (2): dias, peso.perdido\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndf\n\n# A tibble: 40 × 3\n    dias peso.perdido ejercicio\n   &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;    \n 1    14         2.95 no       \n 2    18         5.65 no       \n 3    22         6.56 no       \n 4    26         3.56 no       \n 5    30         6.17 no       \n 6    34         9.4  no       \n 7    38        12.4  no       \n 8    42        12.9  no       \n 9    46        13.9  no       \n10    50        10.8  no       \n# ℹ 30 more rows\n\n\n\n\n\nDibujar el diagrama de dispersión de los kilos perdidos en función del número de días con la dieta. ¿Qué tipo de modelo de regresión se ajusta mejor a la nube de puntos?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\nlibrary(ggplot2)\nggplot(df, aes(x = dias, y = peso.perdido)) +\n    geom_point(col = \"red\") +\n    labs(title = \"Diagrama de dispersión del peso perdido y los días de dieta\", x = \"Días de dieta\", y = \"Peso perdido en Kg\")\n\n\n\n\n\n\n\n\nLa nube de puntos es bastante difusa aunque parece apreciarse una tendencia logarítmica o sigmoidal.\n\n\n\nCalcular los coeficientes de determinación lineal, cuadrático, exponencial, logarítmico, potencial, inverso y sigmoidal. ¿Qué tipo de modelo explica mejor la relación entre los kilos perdidos y el número de días de dieta? ¿Qué porcentaje de la variabilidad de peso perdido explica el mejor modelo de regresión?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(purrr)\nlibrary(broom)\nlibrary(kableExtra)\n\n\nAdjuntando el paquete: 'kableExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\n# Construimos un data frame con el ajuste de los modelos.\nmodelos &lt;- tibble(\n        Lineal = list(lm(peso.perdido ~ dias, df)),\n        Cuadratico = list(lm(peso.perdido ~ dias + I(dias^2), df)),\n        Exponencial = list(lm(log(peso.perdido) ~ dias, df)),\n        Logaritmico = list(lm(peso.perdido ~ log(dias), df)),\n        Potencial = list(lm(log(peso.perdido) ~ log(dias), df)),\n        Inverso = list(lm(peso.perdido ~ I(1/dias), df)),\n        Sigmoidal = list(lm(log(peso.perdido) ~ I(1/dias), df)),\n    )  |&gt; \n    # \n    # Reestructuramos el data frame para tener todos los modelos en la misma columna.\n    pivot_longer(everything(), names_to = \"Tipo_Modelo\", values_to = \"Modelo\")  |&gt; \n    # Obtenemos un resumen del ajuste de cada modelo en formato organizado (se obtiene una lista con los parámetros que describen el ajuste de cada modelo).\n    mutate(Resumen = map(Modelo, glance)) |&gt; \n    # Desanidamos el resumen (se obtiene una columna para cada parámetro del resumen del ajuste de los modelos).\n    unnest(Resumen)  |&gt; \n    # Ordenamos el data frame por el coeficiente de determinación.\n    arrange(-r.squared)\n\nmodelos  |&gt;\n    select(Tipo_Modelo, r.squared)  |&gt; \n    kable(col.names = c(\"Tipo de Modelo\", \"R²\")) |&gt;\n    kable_styling(full_width = F)\n\n\n\n\nTipo de Modelo\nR²\n\n\n\n\nSigmoidal\n0.6662170\n\n\nPotencial\n0.5684490\n\n\nInverso\n0.5583853\n\n\nCuadratico\n0.5397848\n\n\nLogaritmico\n0.5254856\n\n\nLineal\n0.4356390\n\n\nExponencial\n0.4308936\n\n\n\n\n\nEl mejor modelo es el Sigmoidal que explica el 66.6216965% de la variabilidad del peso perdido.\n\n\n\nDibujar el diagrama de dispersión de los kilos perdidos en función del número de días con la dieta según si la persona hace ejercicio o no. ¿Qué conclusiones se pueden sacar?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\nlibrary(ggplot2)\nggplot(df, aes(x = dias, y = peso.perdido, color = ejercicio)) +\n    geom_point() +\n    labs(title = \"Diagrama de dispersión del peso perdido y los días de dieta\", x = \"Días de dieta\", y = \"Peso perdido en Kg\")\n\n\n\n\n\n\n\n\nClaramente la nube de puntos de las personas que hacen ejercicio está por encima de la de los que no hacen ejercicio, lo que indica que hacer ejercicio favorece la pérdida de peso. Los más razonable es construir modelos de regresión para cada grupo.\n\n\n\n¿Qué tipo de modelo explica mejor la relación entre el peso perdido y los días de dieta en el grupo de las personas que hacen ejercicio? ¿Y en el grupo de las que no hacen ejercicio? ¿Han mejorado los modelos con respecto al modelo anterior?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\n\nmodelos &lt;- df  |&gt; \n    # Anidamos por la columna ejercicio.\n    nest_by(ejercicio)  |&gt; \n    # Ajustamos los modelos de regresión.\n    mutate(\n        Lineal = list(lm(peso.perdido ~ dias, data)),\n        Cuadratico = list(lm(peso.perdido ~ dias + I(dias^2), data)),\n        Exponencial = list(lm(log(peso.perdido) ~ dias, data)),\n        Logaritmico = list(lm(peso.perdido ~ log(dias), data)),\n        Potencial = list(lm(log(peso.perdido) ~ log(dias), data)),\n        Inverso = list(lm(peso.perdido ~ I(1/dias), data)),\n        Sigmoidal = list(lm(log(peso.perdido) ~ I(1/dias), data)),\n    )  |&gt; \n    # Reestructuramos el data frame para tener todos los modelos en la misma columna.\n    pivot_longer(-c(ejercicio, data), names_to = \"Tipo_Modelo\", values_to = \"Modelo\")  |&gt; \n    # Obtenemos un resumen del ajuste de cada modelo en formato organizado (se obtiene una lista con los parámetros que describen el ajuste de cada modelo).\n    mutate(Resumen = map(Modelo, glance)) |&gt; \n    # Desanidamos el resumen (se obtiene una columna para cada parámetro del resumen del ajuste de los modelos).\n    unnest(Resumen)  |&gt; \n    # Ordenamos el data frame por la columna ejercicio y por el coeficiente de determinación.\n    arrange(ejercicio, -r.squared)  \nmodelos |&gt; \n    select(ejercicio, Tipo_Modelo, r.squared)  |&gt; \n    kable(col.names = c(\"Ejercicio\", \"Tipo de Modelo\", \"R²\")) |&gt;\n    pack_rows(index = table(modelos$ejercicio))  |&gt; \n    kable_styling(full_width = F)\n\n\n\n\nEjercicio\nTipo de Modelo\nR²\n\n\n\n\nno\n\n\nno\nSigmoidal\n0.7401212\n\n\nno\nCuadratico\n0.7100610\n\n\nno\nInverso\n0.6796880\n\n\nno\nPotencial\n0.6700051\n\n\nno\nLogaritmico\n0.6494521\n\n\nno\nLineal\n0.5286338\n\n\nno\nExponencial\n0.5222832\n\n\nsi\n\n\nsi\nInverso\n0.8470993\n\n\nsi\nSigmoidal\n0.8305013\n\n\nsi\nLogaritmico\n0.7885173\n\n\nsi\nCuadratico\n0.7791671\n\n\nsi\nPotencial\n0.6704843\n\n\nsi\nLineal\n0.6623502\n\n\nsi\nExponencial\n0.4945564\n\n\n\n\n\nEl mejor modelo en el grupo de los que hacen ejercicio es el inverso y en el grupo de los que no el sigmoidal. Los modelos han mejorado bastante con respecto al modelo anterior, sobre todo el del grupo de personas que hace ejercicio.\n\n\n\nConstruir el mejor modelo de regresión del peso perdido sobre los días de dieta para el grupo de las personas que hacen ejercicio y para el grupo de las que no.\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nConstruimos el modelo inverso para el grupo de las personas que hacen ejercicio.\n\ninverso_ejercicio &lt;- lm(peso.perdido ~ I(1/dias), df[df$ejercicio == \"si\", ])\nsummary(inverso_ejercicio)\n\n\nCall:\nlm(formula = peso.perdido ~ I(1/dias), data = df[df$ejercicio == \n    \"si\", ])\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.1866 -1.3268  0.0011  0.9810  4.1456 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   21.5655     0.7653  28.181 2.42e-16 ***\nI(1/dias)   -255.2249    25.5579  -9.986 9.12e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.811 on 18 degrees of freedom\nMultiple R-squared:  0.8471,    Adjusted R-squared:  0.8386 \nF-statistic: 99.72 on 1 and 18 DF,  p-value: 9.123e-09\n\n\n\nY ahora el modelo sigmoidal para el grupo de las personas que no hacen ejercicio.\n\nsigmoidal_no_ejercicio &lt;- lm(log(peso.perdido) ~ I(1/dias), df[df$ejercicio == \"no\", ])\nsummary(sigmoidal_no_ejercicio)\n\n\nCall:\nlm(formula = log(peso.perdido) ~ I(1/dias), data = df[df$ejercicio == \n    \"no\", ])\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.66026 -0.07192  0.04678  0.13142  0.29633 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   2.8694     0.1021   28.09 2.55e-16 ***\nI(1/dias)   -24.4226     3.4111   -7.16 1.15e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2417 on 18 degrees of freedom\nMultiple R-squared:  0.7401,    Adjusted R-squared:  0.7257 \nF-statistic: 51.26 on 1 and 18 DF,  p-value: 1.146e-06\n\n\n\n\n\nSegún los mejores modelos de regresión en cada caso, ¿cuántos kilos perderá una persona que hace ejercicio tras 100 días de dieta? ¿Y una que no hace ejercicio?\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nHacemos primero la predicción del peso perdido para la persona que hace ejercicio usando el modelo inverso.\n\npredict.lm(inverso_ejercicio, newdata = list(dias = 100))\n\n       1 \n19.01329 \n\n\nY ahora hacemos la predicción del peso perdido para la persona que no hace ejercicio usando el modelo sigmoidal.\n\n# El modelo sigmoidal devuelve el logaritmo del peso perdido por lo que hay que aplicar la función exponencial para obtener el peso perdido.\nexp(predict.lm(sigmoidal_no_ejercicio, newdata = list(dias = 100)))\n\n       1 \n13.80634 \n\n\n\n\n\n\n\n\nEjercicio 2.12 En un ensayo se estudia si un polimorfismo en el gen FTO influye en la respuesta a una dieta hipocalórica. El genotipo de los participantes se determina mediante un SNP de tipo A/T y se clasifica a los participantes en tres grupos según su genotipo: homocigotos AA, heterocigotos AT y homocigotos TT. Después de 6 meses de dieta, se clasifica a los participantes en dos grupos según su respuesta a la dieta: respondedores (pérdida de peso clínicamente relevante ≥5%) y no respondedores. Los datos obtenidos están recogidos en el fichero genotipo-respuesta-dieta.csv y se corresponden con la siguiente tabla de contingencia:\n\n\n\nGenotipo FTO\nNo Respondedor\nRespondedor\nTotal\n\n\n\n\nAA\n60\n40\n100\n\n\nAT\n40\n50\n90\n\n\nTT\n25\n35\n60\n\n\nTotal\n125\n125\n250\n\n\n\nContrastar si la respuesta a la dieta depende del genotipo FTO con un nivel de significación del 5%.\n\n\n\n\n\n\n\nTipSolución\n\n\n\n\n\nPrimero creamos la tabla de contingencia a partir del fichero de datos.\n\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(broom)\n# Cargamos los datos en un data frame\ndf &lt;- read.csv(\"datos/genotipo-respuesta-dieta.csv\")\n# Creamos la tabla de contingencia\ntabla_contingencia &lt;- table(df$Genotipo, df$Respuesta)\nkable(tabla_contingencia)\n\n\n\n\n\nNo\nSi\n\n\n\n\nAA\n60\n40\n\n\nAT\n40\n50\n\n\nTT\n25\n35\n\n\n\n\n\nSi no disponemos del fichero de datos, podemos crear directamente la tabla de contingencia con los datos proporcionados.\n\n# Creamos la tabla de contingencia\ntabla_contingencia &lt;- matrix(c(40, 60, 50, 40, 35, 25), nrow = 3, byrow = TRUE)\ndimnames(tabla_contingencia) &lt;- list(c(\"AA\", \"AT\", \"TT\"), c(\"Respondedor\", \"No respondedor\"))\n\nFinalmente aplicamos el contraste de independencia de chi-cuadrado.\n\ntidy(chisq.test(tabla_contingencia)) |&gt; \n    kable()\n\n\n\n\nstatistic\np.value\nparameter\nmethod\n\n\n\n\n6.777778\n0.0337462\n2\nPearson’s Chi-squared test",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Prácticas de contrastes de hipótesis paramétricos con R</span>"
    ]
  }
]